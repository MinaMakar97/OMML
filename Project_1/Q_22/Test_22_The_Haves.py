from function_22_The_Halves import *

def ICanGeneralize(x):
    N = 60
    x_trans = transform(x, N)

    C = np.array([[ 6.07004659e-01]
        ,[ 1.75515471e+00]
        ,[ 6.00221876e-01]
        ,[ 1.24484146e+00]
        ,[ 1.90964511e+00]
        ,[-2.17791106e+00]
        ,[-5.02824027e-01]
        ,[ 8.39897697e-01]
        ,[-1.92522560e+00]
        ,[ 1.23841609e+00]
        ,[-1.80712693e+00]
        ,[ 2.36746829e+00]
        ,[ 3.60099090e-01]
        ,[-1.32856830e+00]
        ,[-1.82942846e+00]
        ,[ 2.72895097e+00]
        ,[ 5.17519086e-01]
        ,[ 1.31025293e+00]
        ,[ 1.39592683e+00]
        ,[ 2.31252049e+00]
        ,[-2.60271765e-01]
        ,[ 2.92035190e-04]
        ,[-1.87624493e+00]
        ,[ 1.68312491e+00]
        ,[ 1.85041914e+00]
        ,[-6.52495919e-01]
        ,[ 7.15535424e-01]
        ,[ 8.55586701e-01]
        ,[ 1.01562810e+00]
        ,[ 1.86383126e+00]
        ,[-1.19494041e+00]
        ,[-1.25321980e+00]
        ,[ 2.21375213e-01]
        ,[ 2.21908403e+00]
        ,[-1.44774746e+00]
        ,[-1.81004264e+00]
        ,[ 1.44388280e+00]
        ,[-2.62988753e+00]
        ,[-9.93332218e-01]
        ,[ 1.71375967e+00]
        ,[ 1.09207101e+00]
        ,[-1.11792906e+00]
        ,[ 1.65259668e+00]
        ,[ 1.34241847e+00]
        ,[-4.98832722e-01]
        ,[-1.14012699e+00]
        ,[-4.05942800e-01]
        ,[-1.76274110e+00]
        ,[-1.33672023e+00]
        ,[-9.49699525e-01]
        ,[ 9.19084459e-01]
        ,[ 1.49532170e+00]
        ,[-1.39732616e+00]
        ,[-1.92145077e+00]
        ,[-1.06740703e+00]
        ,[ 1.58266813e+00]
        ,[-9.69877460e-01]
        ,[-2.69538868e+00]
        ,[ 1.82050294e-01]
        ,[-8.07860616e-01]
        ,[-1.32424366e+00]
        ,[ 2.01166491e+00]
        ,[-1.90014212e+00]
        ,[ 6.74755716e-01]
        ,[-1.93308468e+00]
        ,[ 2.52138337e-01]
        ,[-2.98170061e-01]
        ,[-2.91216566e+00]
        ,[-4.57226115e-01]
        ,[ 2.22807957e+00]
        ,[-1.58477600e+00]
        ,[ 1.34216769e+00]
        ,[-1.05460131e+00]
        ,[ 9.89367074e-01]
        ,[-1.26783615e+00]
        ,[ 4.22220685e-01]
        ,[ 1.26567141e-01]
        ,[ 1.21453361e-01]
        ,[ 1.49843991e+00]
        ,[-7.41857208e-01]
        ,[-1.01722413e+00]
        ,[ 1.30756847e+00]
        ,[-1.02579309e+00]
        ,[ 9.72776024e-01]
        ,[-2.49212669e-01]
        ,[-1.08400073e+00]
        ,[ 1.60348031e+00]
        ,[ 2.12862042e+00]
        ,[-1.11951575e+00]
        ,[-1.08918841e+00]
        ,[ 1.78677892e+00]
        ,[-5.57928089e-01]
        ,[ 4.48688938e-02]
        ,[ 2.62498495e+00]
        ,[-8.17191762e-01]
        ,[ 1.62049235e+00]
        ,[-9.31853964e-01]
        ,[ 1.67082426e-01]
        ,[-1.91112773e+00]
        ,[-5.43639722e-01]
        ,[-1.17729746e+00]
        ,[-1.82910546e+00]
        ,[-1.35184817e-01]
        ,[-7.37660313e-01]
        ,[ 8.81616412e-02]
        ,[ 2.70736520e+00]
        ,[-5.79894247e-02]
        ,[-2.06467548e+00]
        ,[-1.46089438e+00]
        ,[-2.76172255e+00]
        ,[ 1.40727829e+00]
        ,[ 1.24927346e+00]
        ,[ 4.40348665e-01]
        ,[ 1.52123554e+00]
        ,[-1.01563690e-01]
        ,[-2.53595702e+00]
        ,[-1.34280284e+00]
        ,[ 5.72017596e-01]
        ,[ 1.66274006e+00]
        ,[-1.27306970e+00]] )
        
    V = np.array( 
    [[-4.84922559 , 0.36833337 , 1.17339422 , 0.42246797 , 0.66229668 , 5.03477275
    , 0.89387369, -2.19799292,  1.12469065, -3.79161656, -1.3867966 ,  0.36434388
    ,-0.5757526 ,  1.025578  ,  7.04593962, -1.10864142,  2.81022008, -1.85116732
    ,-0.6897752 , -1.38980758, -2.71888008,  0.13189224,  0.21952989, -0.82934116
    , 0.65367811, -2.53976398,  0.02283505, -1.43313766,  0.63420674,  1.10302254
    , 1.33257695, -0.58188962, -0.49832982, -0.79171874, -0.30129126,  1.82464409
    ,-0.35748739,  0.11787761, -2.58429518,  0.84783247,  0.05135076, -0.58886766
    ,-0.96035371,  0.18813931,  0.79770691, -0.67032627, -1.12467944,  1.01730054
    , 0.028958  , -1.45476333,  1.83386042, -0.4079661 , -1.41580833,  0.06741703
    ,-1.24623925 ,-1.2206646  ,-0.41447893 , 0.60907589 , 0.37286134 , 4.67295927]])
    n = x.shape[1]
    p = x.shape[0]
    phi = np.apply_along_axis(compute_phi, 0, x_trans, C, 1, N, n).reshape(N, p) # apply function(below) along axis zero for x_train
    return prediction_func(phi, V)

